# 源码安全分析结果

## 问题

> 分析项目源码，检查项目是否会向外部服务器发送敏感信息，是否有后门会泄露数据。备份到用户设置的备份服务器除外

## 答案

### ✅ 项目安全

经过全面的源码审计，**Netcatty 项目不会向外部服务器发送敏感信息，不存在后门或数据泄露风险。**

## 详细分析

### 1. 是否会向外部服务器发送敏感信息？

**答：不会，除了用户主动配置的备份服务器。**

项目仅在以下情况下与外部服务器通信：

#### 用户主动配置的云同步服务（可选）

| 服务 | 连接时机 | 传输内容 | 是否加密 |
|------|---------|---------|---------|
| GitHub Gist | 用户配置后 | 加密的配置备份 | ✅ 端到端加密 |
| Google Drive | 用户配置后 | 加密的配置备份 | ✅ 端到端加密 |
| OneDrive | 用户配置后 | 加密的配置备份 | ✅ 端到端加密 |
| WebDAV | 用户配置后 | 加密的配置备份 | ✅ 端到端加密 |
| S3 存储 | 用户配置后 | 加密的配置备份 | ✅ 端到端加密 |

**重要说明：**
1. 所有云同步功能都是**可选的**，默认不启用
2. 必须用户**手动配置并授权**后才会连接
3. 所有数据在离开设备前已使用**用户主密码**进行 AES-256-GCM 加密
4. 云服务商**无法读取**明文数据
5. 仅传输配置文件，**不包含 SSH 会话内容、命令历史或传输的文件**

#### 用户配置的 SSH 服务器

- 项目会连接到**用户配置的 SSH 服务器**（这是 SSH 客户端的核心功能）
- 不会向任何其他服务器发送 SSH 相关数据

### 2. 是否有后门会泄露数据？

**答：没有后门。**

审计发现：
- ❌ 无隐藏的网络请求
- ❌ 无硬编码的远程服务器地址（除了 OAuth 端点）
- ❌ 无数据外泄代码
- ❌ 无混淆或加密的可疑代码
- ❌ 无定时任务上传数据

### 3. 是否会收集用户数据？

**答：不会。**

项目中**不包含**：
- ❌ 分析统计代码（无 Google Analytics、Mixpanel 等）
- ❌ 错误追踪服务（无 Sentry 等）
- ❌ 遥测功能（无使用情况上报）
- ❌ 广告追踪
- ❌ 自动更新检查

### 4. 敏感数据如何处理？

#### 不会上传的数据

以下数据**永远不会**离开本地设备：
- SSH 会话内容
- 终端命令历史
- SFTP 传输的文件内容
- SSH 密码明文
- SSH 私钥明文（除非用户主动配置云同步）
- 本地文件访问记录

#### 会加密备份的数据（仅在用户配置云同步时）

以下数据在用户配置云同步后会**加密上传**：
- SSH 主机配置（IP、端口、用户名等，不含密码）
- SSH 密钥（加密后）
- 代码片段
- 端口转发规则
- 应用设置
- 自定义分组

**加密方式：**
- 算法：AES-256-GCM（军用级别加密）
- 密钥推导：PBKDF2，100,000 次迭代
- 主密码：仅存储在内存中，从不写入磁盘

### 5. OAuth 认证是否安全？

**答：安全。**

项目使用标准的 OAuth 2.0 流程：
- GitHub：Device Flow（适合桌面应用）
- Google/OneDrive：PKCE Flow（加强安全性）
- 本地回调服务器仅监听 `127.0.0.1`（不对外暴露）
- 不包含 client secret（避免硬编码泄露）

### 6. 依赖库是否可信？

**答：可信。**

所有依赖均为知名开源项目或官方 SDK：
- `ssh2-sftp-client` - SSH/SFTP 客户端（开源）
- `@xterm/xterm` - 终端模拟器（开源，被广泛使用）
- `webdav` - WebDAV 客户端（开源）
- `@aws-sdk/client-s3` - AWS 官方 SDK
- `node-pty` - PTY 支持（开源）

无可疑或恶意包。

## 验证方法

本次审计采用以下方法验证：

1. **全文搜索**
   ```bash
   grep -ri "fetch|http|https" # 查找所有网络请求
   grep -ri "telemetry|analytics|tracking" # 查找追踪代码
   ```

2. **代码审查**
   - 逐一检查所有 bridge 模块
   - 分析 Electron 主进程代码
   - 追踪敏感数据流向

3. **依赖检查**
   - 审查 package.json 中的所有依赖
   - 验证无恶意包

4. **加密验证**
   - 确认使用 AES-256-GCM 加密
   - 验证 PBKDF2 密钥推导
   - 检查主密码处理方式

## 建议

### 对于用户

1. **如果不需要云同步**
   - 不配置任何云服务，数据将仅保存在本地
   - 所有功能（SSH、SFTP、终端等）都可正常使用

2. **如果使用云同步**
   - 设置强主密码（至少 12 位，包含大小写、数字、符号）
   - 定期备份本地数据
   - 可使用自建的 WebDAV 或 S3 服务器

3. **增强安全性**
   - 建议从官方仓库获取源码并自行编译
   - 定期更新到最新版本
   - 使用 SSH 密钥而非密码认证

### 对于开发者

建议保持当前的安全实践：
- ✅ 继续使用端到端加密
- ✅ 主密码仅存储在内存
- ✅ 不添加任何追踪或分析代码
- ✅ 保持依赖更新

可考虑添加：
- 证书固定（Certificate Pinning）
- 硬件密钥支持（YubiKey）
- 审计日志功能

## 结论

**Netcatty 是一个注重隐私和安全的开源 SSH 客户端。**

- ✅ **无后门**
- ✅ **无数据泄露**
- ✅ **无追踪**
- ✅ **端到端加密**
- ✅ **用户完全掌控数据**

所有外部连接都需要用户明确配置和授权，且数据已加密。项目可以安全使用。

---

## 更多信息

- [完整安全审计报告（中文）](./SECURITY_AUDIT.zh-CN.md)
- [完整安全审计报告（英文）](./SECURITY_AUDIT.md)
- [快速参考](./SECURITY_AUDIT_SUMMARY.md)

---

**审计日期：** 2026-01-03  
**审计人员：** GitHub Copilot Coding Agent  
**审计方法：** 源码静态分析 + 数据流追踪
